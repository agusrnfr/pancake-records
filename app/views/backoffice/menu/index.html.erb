<% content_for :styles do %>
  <%= stylesheet_link_tag "backoffice/index" %>
<% end %>
<div class="backoffice-center">
  <section class="intro">
    <h1>Bienvenido, <%= (current_user.respond_to?(:name) && current_user.name.present?) ? current_user.name : current_user.email %>.</h1>
    <p>Gestioná Pancake Records desde este panel.</p>
    <p>Tu rol es el de <strong><%= current_user.role_name %></strong>.</p>
  </section>
  <section class="permisos-wrapper">
    <h2>Tus permisos</h2>
    <div class="permisos-grid">
      <div class="permiso-card">
        <h3>Usuarios</h3>
        <ul>
          <% if current_user.administrator? %>
            <li>Crear, editar, desactivar cualquier usuario (incluye administradores).</li>
            <li>Administrar roles de todos.</li>
          <% elsif current_user.manager? %>
            <li>Crear, editar y desactivar usuarios (excepto administradores).</li>
            <li>No puede crear ni modificar usuarios con rol de administrador.</li>
          <% else %>
            <li>No puede gestionar usuarios.</li>
            <li>Solo ver y editar sus propios datos (sin cambiar rol).</li>
          <% end %>
        </ul>
      </div>
      <div class="permiso-card">
        <h3>Discos</h3>
        <ul>
          <% if current_user.administrator? || current_user.manager? %>
            <li>Alta, edición y baja lógica.</li>
            <li>Gestión de stock, precios e imágenes.</li>
            <li>Audio (items usados) y metadatos.</li>
          <% else %>
            <li>Consultar y gestionar productos según política interna.</li>
            <li>Actualizar stock y precios dentro de límites.</li>
          <% end %>
        </ul>
      </div>
      <div class="permiso-card">
        <h3>Ventas</h3>
        <ul>
          <% if current_user.administrator? || current_user.manager? %>
            <li>Registrar y cancelar ventas.</li>
            <li>Ver historial completo.</li>
            <li>Generar facturas PDF.</li>
          <% else %>
            <li>Registrar y cancelar ventas (reposición stock al cancelar).</li>
          <% end %>
        </ul>
      </div>
      <div class="permiso-card">
        <h3>Otros</h3>
        <ul>
          <% if current_user.administrator? %>
            <li>Acceso total y auditoría.</li>
            <li>Modificar propios datos (excepto rol) y de cualquiera.</li>
          <% elsif current_user.manager? %>
            <li>Modificar propios datos (excepto rol).</li>
            <li>Sin acceso a auditoría completa.</li>
          <% else %>
            <li>Sin acceso a auditoría.</li>
            <li>Modificar solo datos propios (excepto rol).</li>
          <% end %>
        </ul>
      </div>
    </div>
  </section>
  <iframe data-testid="embed-iframe" style="border-radius:12px" src="https://open.spotify.com/embed/track/3UkYhZrL4RrjQbxxth6uQ0?utm_source=generator" width="100%" height="352" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
</div>
<%= render partial: "backoffice/back_button" %>